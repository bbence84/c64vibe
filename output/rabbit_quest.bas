10 POKE 53280,6:POKE 53281,14:PRINT CHR$(147):C=6:REM BLUE SCREEN
20 DIM L$(22), M%(22,4), I$(11), IL%(11)
30 GOSUB 1000:REM INIT DATA
40 P=1:DL=1:REM START LOCATION AND LOCKED DOOR
50 PRINT CHR$(14):REM LOWERCASE
60 PRINT "TAPSI A VARAZSERDOBEN"
70 PRINT "---------------------"
80 GOSUB 2000:REM LOOK
90 PRINT:INPUT "MIT TESZEL (PL. E, FELVESZ REPA)";C$
100 GOSUB 3000:REM PARSER
110 GOTO 80
1000 REM *** INITIALIZE DATA ***
1010 FOR I=1 TO 21:READ L$(I):NEXT I
1020 FOR I=1 TO 21:FOR J=1 TO 4:READ M%(I,J):NEXT J:NEXT I
1030 FOR I=1 TO 10:READ I$(I),IL%(I):NEXT I
1040 RETURN
2000 REM *** LOOK ***
2010 PRINT CHR$(147)
2020 PRINT CHR$(18);L$(P);CHR$(146)
2030 PRINT "----------------"
2040 FOR I=1 TO 10
2050 IF IL%(I)=P THEN PRINT "ITT VAN EGY: "I$(I)
2060 NEXT I
2070 RETURN
3000 REM *** PARSER ***
3010 V$=LEFT$(C$,1):N$="":SP=0
3020 FOR I=1 TO LEN(C$):IF MID$(C$,I,1)=" " THEN SP=I:I=LEN(C$)
3030 NEXT I
3040 IF SP>0 THEN V$=LEFT$(C$,SP-1):N$=MID$(C$,SP+1,LEN(C$)-SP)
3050 IF V$="E" OR V$="ESZAK" THEN D=1:GOTO 4000
3060 IF V$="D" OR V$="DEL" THEN D=2:GOTO 4000
3070 IF V$="K" OR V$="KELET" THEN D=3:GOTO 4000
3080 IF V$="N" OR V$="NYUGAT" OR V$="NY" THEN D=4:GOTO 4000
3090 IF V$="NEZ" THEN GOSUB 2000:RETURN
3100 IF V$="FELVESZ" THEN GOTO 5000
3110 IF V$="LELTAR" THEN GOTO 6000
3120 IF V$="HASZNAL" THEN GOTO 7000
3130 PRINT "NEM ERTEM.":RETURN
4000 REM *** MOVE ***
4010 NP=M%(P,D)
4020 IF NP=0 THEN PRINT "ARRA NEM MEHETSZ!":RETURN
4030 IF NP=11 AND DL=1 THEN PRINT "AZ AJTO ZARVA VAN!":RETURN
4040 P=NP:GOSUB 8000:RETURN
5000 REM *** TAKE ***
5010 F=0
5020 FOR I=1 TO 10
5030 IF I$(I)=N$ AND IL%(I)=P THEN IL%(I)=0:PRINT "FELVETTED.":F=1:GOSUB 8100:I=10
5040 NEXT I
5050 IF F=0 THEN PRINT "NINCS ITT ILYEN."
5060 RETURN
6000 REM *** INVENTORY ***
6070 PRINT "NALAD VAN:"
6080 C=0
6090 FOR I=1 TO 10:IF IL%(I)=0 THEN PRINT I$(I):C=C+1
6100 NEXT I
6110 IF C=0 THEN PRINT "SEMMI."
6120 RETURN
7000 REM *** USE ***
7010 IF N$="KULCS" AND P=10 AND IL%(3)=0 THEN DL=0:PRINT "KINYITOTTAD A KUNYHOT!":RETURN
7020 PRINT "NEM TORTENT SEMMI."
7030 RETURN
8000 REM *** SOUND MOVE ***
8010 POKE 54296,15:POKE 54277,10:POKE 54273,20:FOR T=1 TO 50:NEXT:POKE 54273,0:RETURN
8100 REM *** SOUND GET ***
8110 POKE 54296,15:POKE 54277,15:POKE 54273,40:FOR T=1 TO 100:NEXT:POKE 54273,0:RETURN
9000 REM *** DATA LOCATIONS ***
9010 DATA "NYULIJ","NAPFENYES RET","OREG TOLGYFA","GOMBAK KORE","CSORGEDEZO PATAK"
9020 DATA "SOTET BARLANG BEJARATA","SOTET BARLANG MELYE","MOKUS ODUJA","VIRAGOS TISZTAS","ELHAGYOTT KUNYHO"
9030 DATA "KUNYHO BELSEJE","VARAZSLATOS FORRAS","TUSKES BOZOT","MAGAS SZIKLA","SAS FESZKE"
9040 DATA "REJTETT OSVENY","BOLCS BAGOLY FAJA","KRISTALYTO","TUNDEREK LIGETE","KODOS MOCSAR"
9050 DATA "ARANYKAPU"
9100 REM *** DATA MOVES (N,S,E,W) 0=BLOCK ***
9110 DATA 2,0,0,0, 3,1,4,5, 0,2,0,0, 0,0,0,2, 0,0,2,6
9120 DATA 0,0,5,0, 0,6,0,0, 0,0,0,3, 0,3,10,0, 0,0,0,9
9130 DATA 0,10,0,0, 0,0,0,0, 14,9,0,0, 0,13,15,16, 0,0,0,14
9140 DATA 0,0,14,17, 0,0,16,0, 0,0,0,16, 0,0,0,18, 0,19,21,0
9150 DATA 0,20,0,0
9200 REM *** DATA ITEMS (NAME, LOC) ***
9210 DATA "REPA",2,"MAKK",3,"KULCS",8,"LAMPAS",11,"OLAJ",5
9220 DATA "VARAZSPOR",19,"KAVICS",5,"TOLL",15,"GOMBA",4,"VARAZSPALCA",18
